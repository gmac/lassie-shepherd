/*** Lassie Engine Game Player* @author Greg MacWilliam.*/package com.lassie.player.control{	import com.lassie.player.model.DialogueTreeTopic;	import com.lassie.utils.XmlUtil;	final internal class TreeControl extends ProcessCommand	{		/**		* <tree load="treeId" enableTopic="room:tree:topic:1"/>		*/		public function TreeControl():void {			super();		}	//-------------------------------------------------	// Process methods	//-------------------------------------------------		override public function toString():String {			return "[TreeControl]";		}	//-------------------------------------------------	// Control methods	//-------------------------------------------------		override protected function _run():void		{			var $load:String = _sourceXML.@load;			var $populate:String = _sourceXML.@populate;			var $enableTopic:String = _sourceXML.@enableTopic;			var $omitTopic:String = _sourceXML.@omitTopic;			/*			* Loads / populates a dialogue tree.			*/			if ($load != "")			{				// load a new tree menu				uiTreeMenu.load($load);			}			else if ($populate != "")			{				// populate a tree tier within an existing menu.				uiTreeMenu.populate($populate);			}			/*			* Enables/disables an individual topic item.			*/			if ($enableTopic != "") _setTopicEnabled( $enableTopic );			/*			* Omits a topic item.			*/			if ($omitTopic != "") _setTopicEnabled( $omitTopic, true );			_complete();		}		/**		* Sets the enabled status of a topic line.		*/		private function _setTopicEnabled($action:String, $omit:Boolean=false):void		{			// Break "enableTopic" field into four components.			var $targets:Array = Targeting.parseTargetList($action, ":", 4);			var $roomId:String = Targeting.getRoomId( $targets[0] );			var $treeId:String = $targets[1];			var $topicId:String = $targets[2];			var $enable:Boolean = XmlUtil.parseBoolean($targets[3], true);			try {				// attempt to set the enabled status of the requested topic.				if ($omit) gameModel.getRoom( $roomId ).getTree( $treeId ).getTopicById( $topicId ).omit = $enable;				else gameModel.getRoom( $roomId ).getTree( $treeId ).getTopicById( $topicId ).enabled = $enable;			} catch ($error:Error) {				// do nothing.			}		}		override public function skip():void {			_run();		}	}}